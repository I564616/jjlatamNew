<?xml version="1.0" encoding="UTF-8"?>
<!-- FINAL Working Hybris Outbound â€“ HttpClient5 Compatible -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:oxm="http://www.springframework.org/schema/oxm"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
           http://www.springframework.org/schema/oxm
           http://www.springframework.org/schema/oxm/spring-oxm-3.1.xsd">

    <!-- =============================
         PROOF OF DELIVERY TEMPLATE
    ============================== -->
    <bean id="webserviceTemplateForProofOfDelivery"
          class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="defaultUri"
                  value="#{configurationService.configuration.getProperty('jnj.webservice.proof.delivery.endpoint.url')}" />
        <property name="marshaller" ref="marshallerForProofOfDelivery"/>
        <property name="unmarshaller" ref="unmarshallerForProofOfDelivery"/>
    </bean>

    <oxm:jaxb2-marshaller id="marshallerForProofOfDelivery"
                          context-path="com.fedex.ws.track.v8"/>
    <oxm:jaxb2-marshaller id="unmarshallerForProofOfDelivery"
                          context-path="com.fedex.ws.track.v8"/>


    <!-- =============================
         CREATE DELIVERED ORDER TEMPLATE
    ============================== -->
    <bean id="webserviceTemplateForCreateDelivered"
          class="org.springframework.ws.client.core.WebServiceTemplate">
        <!-- leave empty, mapper/service will set values -->
    </bean>


    <!-- =============================
         HTTP CLIENT 5 CONFIGURATION
    ============================== -->

    <!-- Timeouts (Hybris + Spring-WS compatible) -->
    <bean id="messageSender"
          class="org.springframework.ws.transport.http.HttpComponents5MessageSender">
        <constructor-arg ref="httpClient5"/>
    </bean>


    <!-- =============================
         CREDENTIALS CONFIG
    ============================== -->

    <bean id="lacredentials" class="org.apache.hc.client5.http.auth.UsernamePasswordCredentials">
        <constructor-arg index="0"
                         value="#{configurationService.configuration.getProperty('jnj.webservice.order.user')}"/>
        <constructor-arg index="1"
                         value="#{configurationService.configuration.getProperty('jnj.webservice.order.password')}"/>
    </bean>

    <bean id="laAuthScope" class="org.apache.hc.client5.http.auth.AuthScope">
        <constructor-arg>
            <bean class="org.apache.hc.core5.http.HttpHost">
                <constructor-arg index="0"><null/></constructor-arg>
                <constructor-arg index="1" value="-1"/>
            </bean>
        </constructor-arg>
    </bean>

    <bean id="credentialsProvider"
          class="org.apache.hc.client5.http.impl.auth.BasicCredentialsProvider"/>

    <bean id="registerCredentials"
          class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
        <property name="targetObject" ref="credentialsProvider"/>
        <property name="targetMethod" value="setCredentials"/>
        <property name="arguments">
            <list>
                <ref bean="laAuthScope"/>
                <ref bean="lacredentials"/>
            </list>
        </property>
    </bean>

    <!-- =============================
         HTTPCLIENT 5 BUILDER
    ============================== -->
<!--    <bean id="httpClient5Builder"-->
<!--          class="org.apache.hc.client5.http.impl.classic.HttpClients"-->
<!--          factory-method="custom">-->
<!--        <property name="defaultCredentialsProvider" ref="credentialsProvider"/>-->
<!--    </bean>-->

    <bean id="requestConfig" class="org.apache.hc.client5.http.config.RequestConfig">
        <constructor-arg>
            <bean class="org.apache.hc.client5.http.config.RequestConfig$Builder" factory-method="create">
                <property name="connectTimeout"
                          value="#{T(java.time.Duration).ofMillis(configurationService.configuration.getLong('jnj.webservice.connectionTimeOut'))}" />
                <property name="responseTimeout"
                          value="#{T(java.time.Duration).ofMillis(configurationService.configuration.getLong('jnj.webservice.readTimeOut'))}" />
            </bean>
        </constructor-arg>
    </bean>


    <bean id="httpClient5Builder"
          class="org.apache.hc.client5.http.impl.classic.HttpClients"
          factory-method="custom">
        <property name="defaultCredentialsProvider" ref="credentialsProvider"/>
        <property name="defaultRequestConfig" ref="requestConfig"/>
    </bean>



    <!-- =============================
         ALL OTHER WEB SERVICE TEMPLATES
    ============================== -->

    <alias name="webserviceTemplateForSimulate" alias="webserviceTemplateForSimulateDelivered"/>

    <bean id="webserviceTemplateForSimulate"
          class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="marshaller" ref="marshallerForSimulate"/>
        <property name="unmarshaller" ref="unmarshallerForSimulate"/>
    </bean>

    <oxm:jaxb2-marshaller id="marshallerForSimulate"
                          context-path="com.jnj.hcswmd01.mu007_epic_ordersimulate_v1.ordersimulatewebservice"/>
    <oxm:jaxb2-marshaller id="unmarshallerForSimulate"
                          context-path="com.jnj.hcswmd01.mu007_epic_ordersimulate_v1.ordersimulatewebservice"/>


    <bean id="webserviceTemplateForCreate"
          class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="marshaller" ref="marshallerForCreate"/>
        <property name="unmarshaller" ref="unmarshallerForCreate"/>
    </bean>

    <oxm:jaxb2-marshaller id="marshallerForCreate"
                          context-path="com.jnj.hcswmd01.mu007_epic_ordercreate_v1.ordercreationinsapwebservice"/>
    <oxm:jaxb2-marshaller id="unmarshallerForCreate"
                          context-path="com.jnj.hcswmd01.mu007_epic_ordercreate_v1.ordercreationinsapwebservice"/>



    <!-- Message Senders -->
<!--    <bean id="messageSender" class="org.springframework.ws.transport.http.HttpComponents5MessageSender">-->
<!--        <constructor-arg ref="httpClient5"/>-->
<!--    </bean>-->

<!--    <bean id="gtMessageSender" class="org.springframework.ws.transport.http.HttpComponents5MessageSender">-->
<!--        <constructor-arg ref="gtHttpClient"/>-->
<!--    </bean>-->

    <!-- ======================================================
         WEB SERVICE TEMPLATES
    ======================================================= -->

    <!-- MAIN SALES ORDER WS -->
    <bean id="webserviceTemplate" class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="defaultUri" value="http://itsusmpl00082.jnj.com:7996/ws/SG910_BtB_IN0498_SalesOrder_Global_Source_v1.webService.salesOrderWS"/>
        <property name="marshaller" ref="marshaller"/>
        <property name="unmarshaller" ref="unmarshaller"/>
    </bean>

    <!-- NFE -->
    <bean id="webserviceTemplateForNfe" class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="defaultUri" value="http://itsusmpl00082.jnj.com:7996/ws/SG910_BtB_IN0501_ElectronicNotaFiscal_Hybris_Source_v1.webservices.receiveElectronicNotaFiscalWS"/>
        <property name="marshaller" ref="marshallerNFe"/>
        <property name="unmarshaller" ref="unmarshallerNFe"/>
        <property name="messageSender" ref="messageSender"/>
    </bean>

    <!-- INVOICE -->
    <bean id="webserviceTemplateForInvoice" class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="defaultUri" value="http://itsusmpl00082.jnj.com:7996/ws/SG910_BtB_IN0504_ElectronicBilling_Hybris_Source_v1.webservices.receiveElectronicBillingWS"/>
        <property name="marshaller" ref="marshallerInvoice"/>
        <property name="unmarshaller" ref="unmarshallerInvoice"/>
        <property name="messageSender" ref="messageSender"/>
    </bean>

    <!-- PLACEHOLDER WS BEANS (for mappers needing them) -->
<!--    <bean id="webserviceTemplateForCreate" class="org.springframework.ws.client.core.WebServiceTemplate"/>-->
    <bean id="webserviceTemplateForPriceQuote" class="org.springframework.ws.client.core.WebServiceTemplate"/>
    <bean id="webserviceTemplateForOrderReturn" class="org.springframework.ws.client.core.WebServiceTemplate"/>
    <bean id="webserviceTemplateForConsignmentStock" class="org.springframework.ws.client.core.WebServiceTemplate"/>
    <bean id="webserviceTemplateForOrderChange" class="org.springframework.ws.client.core.WebServiceTemplate"/>

    <!-- ======================================================
         MARSHALLERS
    ======================================================= -->

    <oxm:jaxb2-marshaller id="marshaller"
                          context-path="com.jnj.itsusmpl00082.sg910_btb_in0498_salesorder_global_source_v1_webservice.salesorderws"/>

    <oxm:jaxb2-marshaller id="unmarshaller"
                          context-path="com.jnj.itsusmpl00082.sg910_btb_in0498_salesorder_global_source_v1_webservice.salesorderws"/>

    <oxm:jaxb2-marshaller id="marshallerNFe"
                          context-path="com.jnj.itsusmpl00082.sg910_btb_in0501_electronicnotafiscal_hybris_source_v1_webservices.receiveelectronicnotafiscalws"/>

    <oxm:jaxb2-marshaller id="unmarshallerNFe"
                          context-path="com.jnj.itsusmpl00082.sg910_btb_in0501_electronicnotafiscal_hybris_source_v1_webservices.receiveelectronicnotafiscalws"/>

    <oxm:jaxb2-marshaller id="marshallerInvoice"
                          context-path="com.jnj.itsusmpl00082.sg910_btb_in0504_electronicbilling_hybris_source_v1_webservices.receiveelectronicbillingws"/>

    <oxm:jaxb2-marshaller id="unmarshallerInvoice"
                          context-path="com.jnj.itsusmpl00082.sg910_btb_in0504_electronicbilling_hybris_source_v1_webservices.receiveelectronicbillingws"/>

    <!-- ======================================================
         RESPONSE BEANS (required for LATAM + UI layers)
    ======================================================= -->

    <bean id="salesOrderCreationResponse"
          class="com.jnj.itsusmpl00082.sg910_btb_in0498_salesorder_global_source_v1_webservice.salesorderws.SalesOrderCreationResponse"/>

    <bean id="salesOrderSimulationResponse"
          class="com.jnj.itsusmpl00082.sg910_btb_in0498_salesorder_global_source_v1_webservice.salesorderws.SalesOrderSimulationResponse"/>

    <bean id="salesOrderPricingResponse"
          class="com.jnj.itsusmpl00082.sg910_btb_in0498_salesorder_global_source_v1_webservice.salesorderws.SalesOrderPricingResponse"/>

    <bean id="electronicNotaFiscalResponse"
          class="com.jnj.itsusmpl00082.sg910_btb_in0501_electronicnotafiscal_hybris_source_v1_webservices.receiveelectronicnotafiscalws.ElectronicNotaFiscalResponse"/>

    <!-- ======================================================
         BUSINESS SERVICES
    ======================================================= -->

    <bean id="jnjSalesOrder" class="com.jnj.outboundservice.services.order.impl.DefaultJnjSalesOrder"/>
    <bean id="jnjNfeService" class="com.jnj.outboundservice.services.nfe.impl.DefaultJnjNfeService"/>
    <bean id="jnjInvoiceDoc" class="com.jnj.outboundservice.services.invoice.impl.DefaultJnjInvoiceDoc"/>

    <!-- GT Services -->
    <bean id="jnjGTSimulateOrderMapper" class="com.jnj.gt.outbound.mapper.impl.DefaultJnjGTSimulateOrderMapper"/>
    <bean id="jnjGTSimulateOrderService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTSimulateOrderService"/>
    <bean id="jnjGTSimulateDeliveredOrderService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTSimulateDeliveredOrderService"/>
    <bean id="jnjGTCreateDeliveredOrderService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTCreateDeliveredOrderService"/>
    <bean id="jnjGTReqOrderChangeMapper" class="com.jnj.gt.outbound.mapper.impl.DefaultJnjGTReqOrderChangeMapper"/>
    <bean id="jnjGTReqOrderChangeService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTReqOrderChangeService"/>
    <bean id="jnjGTGetPriceQuoteService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTGetPriceQuoteService"/>
    <bean id="jnjGTOrderReturnService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTOrderReturnService"/>
    <bean id="jnjGTConsignmentStockService" class="com.jnj.gt.outbound.services.impl.DefaultJnjGTConsignmentStockService"/>

    <bean id="jnjGTConsInventoryReportMapper" class="com.jnj.gt.outbound.mapper.impl.DefaultJnjGTConsInventoryReportMapper">
        <property name="jnjGTConsignmentStockService" ref="jnjGTConsignmentStockService"/>
    </bean>

</beans>
